var Retag={};Retag.Collection=function(){function t(t){this._index=0,this._tags=[],this._observers=[],this._onAdd=null,this._onDelete=null,this._onAdd=t&&"function"==typeof t.onAdd?t.onAdd:null,this._onDelete=t&&"function"==typeof t.onDelete?t.onDelete:null,this._allowEquals=t&&"boolean"==typeof t.allowEquals?t.allowEquals:!0,this._minLength=t&&"number"==typeof t.minLength?t.minLength:2}return t.prototype._add=function(t){return!this._allowEquals&&this._has(t)?!1:this._minLength>t.length?!1:(t=this._onAdd?this._onAdd(t,this._tags):t,void(t&&(this._index++,this._tags.push({tag:t,key:""+this._index}))))},t.prototype._fire=function(){for(var t=0;t<this._observers.length;t++)this._observers[t]()},t.prototype._has=function(t){for(var e=0;e<this._tags.length;e++)if(this._tags[e].tag.toLowerCase()===t.toLowerCase())return!0;return!1},t.prototype.addRange=function(t){for(var e=0;e<t.length;e++){var s=t[e];s&&""!==s&&this._add(s)}this._fire()},t.prototype.add=function(t){t&&""!==t&&(this._add(t),this._fire())},t.prototype.remove=function(t){var e=this._onDelete?this._onDelete(t,this._tags):!0;if(e)for(var s=0;s<this._tags.length;s++)if(this._tags[s].key===t)return this._tags.splice(s,1),void this._fire()},t.prototype.clear=function(){this._index=0,this._tags=[],this._fire()},t.prototype.getTags=function(){for(var t=new Array(this._tags.length),e=0;e<this._tags.length;e++)t[e]=this._tags[e].tag;return t},t.prototype.listen=function(t){t&&this._observers.push(t)},t}(),Retag.Input=React.createClass({displayName:"Input",propTypes:{breaks:React.PropTypes.array,suggestions:React.PropTypes.array,suggestions_max:React.PropTypes.number,suggestions_start_size:React.PropTypes.number,collection:React.PropTypes.object.isRequired,css:React.PropTypes.string,handleBlur:React.PropTypes.bool,handleEnter:React.PropTypes.bool},getDefaultProps:function(){return{breaks:[","," "],suggestions:[],suggestions_max:15,suggestions_start_size:1,css:"tag-input",handleBlur:!1,handleEnter:!1}},getInitialState:function(){return{text:"",breaks:this.props.breaks,lTags:[]}},breaks:function(t){for(var e=this.state.breaks,s=0;s<e.length;s++)if(-1!==t.indexOf(e[s]))return!0;return!1},checkEvent:function(t){var e=t.target.value;"blur"===t.type&&this.props.handleBlur?this.addTag(e):"change"===t.type?this.textChange(e):"keyup"===t.type&&13===t.keyCode&&this.props.handleEnter&&(t.preventDefault(),this.addTag(e))},addTag:function(t){this.props.collection.addRange(t.split(new RegExp("["+this.state.breaks.join("")+"]"))),this.setState({lTags:[],text:""})},textChange:function(t){this.breaks(t)||t===this.state.text?1!==t.length&&this.addTag(t):(this.queryAutoComplete(t),this.setState({text:t}))},queryAutoComplete:function(t){var e=[];t.length>=this.props.suggestions_start_size&&(e=this.props.suggestions.filter(function(e){return e.toLowerCase().indexOf(t.toLowerCase())>-1}).sort(function(e){return e.toLowerCase().indexOf(t.toLowerCase())}).slice(0,this.props.suggestions_max)),this.setState({lTags:e})},render:function(){var t=React.createElement("input",{ref:"txt_tag",className:this.props.css,type:"text",value:this.state.text,onChange:this.checkEvent,onBlur:this.checkEvent,onKeyUp:this.checkEvent,list:"lTags"}),e=React.createElement("datalist",{id:"lTags"},this.state.lTags.map(function(t,e){return React.createElement("option",{key:e,value:t})}.bind(this)));return React.createElement("div",null," ",t," ",e," ")}}),Retag.Tags=React.createClass({displayName:"Tags",getInitialState:function(){return{tags:[]}},propTypes:{collection:React.PropTypes.object.isRequired},componentDidMount:function(){var t=this,e=this.props.collection;e.listen(function(){t.setState({tags:e._tags})})},removeTag:function(t){var e=t.target.getAttribute("data-tag");this.props.collection.remove(e)},_mapper:function(t){var e=this;return React.createElement("div",{key:t.key,className:e.props.css||"tag"},t.tag,React.createElement("button",{"data-tag":t.key,style:{display:"inline"},className:e.props.deleteCss||"tag-delete",onClick:e.removeTag},"  "))},render:function(){return React.createElement("div",null,this.state.tags.map(this._mapper))}});